{% comment %}
Requires id~
{% endcomment %}
{% assign the_id = 'general' %}
{% if id %}
{% assign the_id = id %}
{% endif %}
{%capture classes %}newsletter-form{% if class %} {{ class }}{% endif %}{% endcapture %}

{%- form 'customer', id: the_id, class: classes -%}
  <input type="hidden" name="contact[tags]" value="newsletter">
  <div class="newsletter-form__field-wrapper">
    <div class="field">
      <input
       id="NewsletterForm--{{ section.id }}"
      type="email"
      name="contact[email]"
      class="field__input"
      value="{{ form.email }}"
      aria-required="true"
      autocorrect="off"
      autocapitalize="off"
      autocomplete="email"
      {% if form.errors %}
        autofocus
        aria-invalid="true"
        aria-describedby="ContactFooter-error"
      {% elsif form.posted_successfully? %}
        aria-describedby="ContactFooter-success"
      {% endif %}
      placeholder="{{ 'newsletter.label' | t }}"
      required
      >
    <label class="field__label" for="NewsletterForm--{{ section.id }}">
      {{ 'newsletter.label' | t }}
    </label>
    <button type="submit" class="newsletter-form__button field__button" name="commit" id="Subscribe" aria-label="{{ 'newsletter.button_label' | t }}">
      {% render 'icon-arrow' %}
    </button>
  </div>
  </div>
  {%- if form.errors -%}
    <small class="newsletter-form__message form__message" id="ContactFooter-error">{% render 'icon-error' %}{{ form.errors.translated_fields['email'] | capitalize }} {{ form.errors.messages['email'] }}</small>
  {%- endif -%}
  {%- if form.posted_successfully? -%}
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script>
      function sendToast () {
        Toastify({
          text: "{{ 'newsletter.success' | t }}",
          duration: 7000,
          position: "center",
          style: {
          background: "rgba(0,0,0,0.9)",
          color: "white"
        }
        }).showToast();
      }
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js" onload="window.sendToast()"></script>
    <h3 class="newsletter-form__message newsletter-form__message--success form__message" id="ContactFooter-success" tabindex="-1" autofocus>{% render 'icon-success' %}{{ 'newsletter.success' | t }}</h3>
  {%- endif -%}
{%- endform -%}